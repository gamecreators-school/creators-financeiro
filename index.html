<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gest√£o Financeira Escolar</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-form {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 400px;
        }

        .login-form h2 {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
            font-size: 28px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn-success { background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%); }
        .btn-danger { background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%); }
        .btn-warning { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .btn-info { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }

        .main-container {
            display: none;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            color: #333;
            font-size: 24px;
        }

        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            overflow: hidden;
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: #666;
            transition: all 0.3s;
            min-width: 120px;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            display: none;
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .tab-content.active {
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .stat-card h3 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .stat-card p {
            font-size: 14px;
            opacity: 0.9;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        .status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .status.ativo { background: #d4edda; color: #155724; }
        .status.trancado { background: #f8d7da; color: #721c24; }
        .status.pendente { background: #fff3cd; color: #856404; }
        .status.inadimplente { background: #f8d7da; color: #721c24; }
        .status.black { background: #343a40; color: #ffffff; }
        .status.blackin { background: #6c757d; color: #ffffff; }
        .status.formados { background: #d1ecf1; color: #0c5460; }
        .status.pago { background: #d4edda; color: #155724; }
        .status.vencido { background: #f8d7da; color: #721c24; }
        .status.entrada { background: #d4edda; color: #155724; }
        .status.saida { background: #f8d7da; color: #721c24; }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }

        .search-bar {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 20px;
        }

        .file-upload {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin: 10px 0;
            transition: border-color 0.3s;
            cursor: pointer;
        }

        .file-upload:hover {
            border-color: #667eea;
        }

        .file-upload input[type="file"] {
            display: none;
        }

        .alert {
            padding: 12px 16px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 500;
        }

        .alert-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .alert-danger { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .alert-warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }

        .filter-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #ddd;
            border-radius: 20px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .contracts-section, .admin-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px dashed #dee2e6;
        }

        .contract-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 10px;
            background: white;
        }

        .payroll-history, .report-section {
            margin-top: 20px;
        }

        .payroll-item, .report-item {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 10px;
            background: #f9f9f9;
        }

        .sync-status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: 500;
        }

        .sync-success { background: #d4edda; color: #155724; }
        .sync-error { background: #f8d7da; color: #721c24; }
        .sync-warning { background: #fff3cd; color: #856404; }

        .link-input {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .link-input input {
            flex: 1;
        }

        .month-selector {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 20px;
        }

        .boleto-actions {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }
            
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .filter-section {
                flex-direction: column;
                align-items: stretch;
            }

            .boleto-actions {
                flex-direction: column;
            }

            .boleto-actions .btn {
                margin: 2px 0;
            }
        }
    </style>
</head>
<body>
    <!-- Tela de Login -->
    <div id="loginContainer" class="login-container">
        <form class="login-form" onsubmit="return handleLogin(event)">
            <h2>Sistema Escolar</h2>
            <div class="form-group">
                <label>Usu√°rio:</label>
                <input type="text" id="username" required>
            </div>
            <div class="form-group">
                <label>Senha:</label>
                <input type="password" id="password" required>
            </div>
            <button type="submit" class="btn" style="width: 100%;">Entrar</button>
        </form>
    </div>

    <!-- Sistema Principal -->
    <div id="mainContainer" class="main-container">
        <div class="header">
            <h1>Sistema de Gest√£o Financeira Escolar</h1>
            <div>
                <span id="userInfo">Usu√°rio: Admin</span>
                <button class="btn btn-danger" onclick="logout()">Sair</button>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="tab active" onclick="showTab('dashboard')">Dashboard</button>
            <button class="tab" onclick="showTab('alunos')">Alunos</button>
            <button class="tab" onclick="showTab('financeiro')">Financeiro</button>
            <button class="tab" onclick="showTab('relatorios')">Relat√≥rios</button>
            <button class="tab" onclick="showTab('rh')">RH</button>
            <button class="tab" onclick="showTab('caixa')">Caixa</button>
            <button class="tab" onclick="showTab('contratos')">Contratos</button>
            <button class="tab" onclick="showTab('admin')">Admin</button>
        </div>

        <!-- Dashboard -->
        <div id="dashboard" class="tab-content active">
            <h2>Dashboard</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="totalAlunos">0</h3>
                    <p>Total de Alunos</p>
                </div>
                <div class="stat-card">
                    <h3 id="alunosAtivos">0</h3>
                    <p>Alunos Ativos</p>
                </div>
                <div class="stat-card">
                    <h3 id="alunosTrancados">0</h3>
                    <p>Trancados</p>
                </div>
                <div class="stat-card">
                    <h3 id="alunosInadimplentes">0</h3>
                    <p>Inadimplentes</p>
                </div>
                <div class="stat-card">
                    <h3 id="alunosBlack">0</h3>
                    <p>Black</p>
                </div>
                <div class="stat-card">
                    <h3 id="alunosBlackin">0</h3>
                    <p>Blackin</p>
                </div>
                <div class="stat-card">
                    <h3 id="alunosFormados">0</h3>
                    <p>Formados</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalReceber">R$ 0,00</h3>
                    <p>Total a Receber (M√™s)</p>
                </div>
            </div>
        </div>

        <!-- Alunos -->
        <div id="alunos" class="tab-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2>Gest√£o de Alunos</h2>
                <button class="btn btn-success" onclick="showModal('modalAluno')">Novo Aluno</button>
            </div>
            
            <!-- Filtros de Status -->
            <div class="filter-section">
                <strong>Filtrar por Status:</strong>
                <button class="filter-btn active" onclick="filtrarPorStatus('todos')">Todos</button>
                <button class="filter-btn" onclick="filtrarPorStatus('ativo')">Ativos</button>
                <button class="filter-btn" onclick="filtrarPorStatus('trancado')">Trancados</button>
                <button class="filter-btn" onclick="filtrarPorStatus('pendente')">Pendentes</button>
                <button class="filter-btn" onclick="filtrarPorStatus('inadimplente')">Inadimplentes</button>
                <button class="filter-btn" onclick="filtrarPorStatus('black')">Black</button>
                <button class="filter-btn" onclick="filtrarPorStatus('blackin')">Blackin</button>
                <button class="filter-btn" onclick="filtrarPorStatus('formados')">Formados</button>
            </div>
            
            <input type="text" class="search-bar" placeholder="Pesquisar alunos..." onkeyup="filtrarAlunos(this.value)">
            
            <div class="table-container">
                <table id="tabelaAlunos">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Respons√°vel</th>
                            <th>Status</th>
                            <th>Mensalidade</th>
                            <th>Vencimento</th>
                            <th>Situa√ß√£o Pagamento</th>
                            <th>Contrato</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="listaAlunos"></tbody>
                </table>
            </div>
        </div>

        <!-- Financeiro -->
        <div id="financeiro" class="tab-content">
            <h2>Gest√£o Financeira</h2>
            
            <!-- Filtros de Data e Status -->
            <div class="filter-section">
                <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                    <div>
                        <strong>Per√≠odo:</strong>
                        <input type="month" id="filtroMesFinanceiro" onchange="filtrarFinanceiroPorData()">
                    </div>
                    <div>
                        <strong>Data Espec√≠fica:</strong>
                        <input type="date" id="filtroDataFinanceiro" onchange="filtrarFinanceiroPorData()">
                    </div>
                    <button class="btn btn-info" onclick="limparFiltrosDatas()">Limpar Filtros</button>
                    <button class="btn btn-success" onclick="exportarRelatorioFinanceiro()">Exportar Relat√≥rio</button>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="boletosVencidos">0</h3>
                    <p>Boletos Vencidos</p>
                </div>
                <div class="stat-card">
                    <h3 id="boletosHoje">0</h3>
                    <p>Vencem Hoje</p>
                </div>
                <div class="stat-card">
                    <h3 id="pagosCartao">0</h3>
                    <p>Pagos no Cart√£o</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalMensal">R$ 0,00</h3>
                    <p>Faturamento Mensal</p>
                </div>
            </div>

            <div class="table-container">
                <table id="tabelaFinanceiro">
                    <thead>
                        <tr>
                            <th>Aluno</th>
                            <th>Valor</th>
                            <th>Vencimento</th>
                            <th>Status</th>
                            <th>Forma Pagamento</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="listaFinanceiro"></tbody>
                </table>
            </div>
        </div>

        <!-- Nova Aba Relat√≥rios -->
        <div id="relatorios" class="tab-content">
            <h2>Relat√≥rios Mensais</h2>
            
            <div class="month-selector">
                <strong>Selecionar Per√≠odo:</strong>
                <select id="mesRelatorio">
                    <option value="1">Janeiro</option>
                    <option value="2">Fevereiro</option>
                    <option value="3">Mar√ßo</option>
                    <option value="4">Abril</option>
                    <option value="5">Maio</option>
                    <option value="6">Junho</option>
                    <option value="7">Julho</option>
                    <option value="8">Agosto</option>
                    <option value="9">Setembro</option>
                    <option value="10">Outubro</option>
                    <option value="11">Novembro</option>
                    <option value="12">Dezembro</option>
                </select>
                <select id="anoRelatorio">
                    <option value="2025">2025</option>
                    <option value="2024">2024</option>
                    <option value="2023">2023</option>
                </select>
                <button class="btn btn-info" onclick="gerarRelatorioMensal()">Gerar Relat√≥rio</button>
                <button class="btn btn-success" onclick="exportarRelatorio()">Exportar PDF</button>
            </div>
            
            <div id="relatorioConteudo" class="report-section">
                <p>Selecione um per√≠odo e clique em "Gerar Relat√≥rio" para visualizar os dados.</p>
            </div>
        </div>

        <!-- RH -->
        <div id="rh" class="tab-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2>Recursos Humanos</h2>
                <button class="btn btn-success" onclick="showModal('modalFuncionario')">Novo Funcion√°rio</button>
            </div>
            
            <div class="table-container">
                <table id="tabelaRH">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Cargo</th>
                            <th>Sal√°rio</th>
                            <th>Status</th>
                            <th>Faltas no M√™s</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="listaFuncionarios"></tbody>
                </table>
            </div>
        </div>

        <!-- Caixa -->
        <div id="caixa" class="tab-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2>Controle de Caixa</h2>
                <div>
                    <button class="btn btn-success" onclick="showModal('modalEntrada')">Entrada</button>
                    <button class="btn btn-danger" onclick="showModal('modalSaida')">Sa√≠da</button>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="totalEntradas">R$ 0,00</h3>
                    <p>Total Entradas</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalSaidas">R$ 0,00</h3>
                    <p>Total Sa√≠das</p>
                </div>
                <div class="stat-card">
                    <h3 id="saldoCaixa">R$ 0,00</h3>
                    <p>Saldo Atual</p>
                </div>
            </div>

            <div class="table-container">
                <table id="tabelaCaixa">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Tipo</th>
                            <th>Descri√ß√£o</th>
                            <th>Valor</th>
                            <th>Respons√°vel</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="listaCaixa"></tbody>
                </table>
            </div>
        </div>

        <!-- Contratos -->
        <div id="contratos" class="tab-content">
            <h2>Gerenciamento de Contratos</h2>
            
            <div class="contracts-section">
                <h3>Contratos Armazenados</h3>
                <div id="listaContratos">
                    <!-- Lista de contratos ser√° preenchida via JavaScript -->
                </div>
            </div>
        </div>

        <!-- Admin -->
        <div id="admin" class="tab-content">
            <h2>Configura√ß√µes do Sistema</h2>
            
            <div class="admin-section">
                <h3>Integra√ß√£o Google Sheets</h3>
                <div id="syncStatus" class="sync-status sync-warning">
                    Status: N√£o conectado
                </div>
                
                <div class="form-group">
                    <label>ID da Planilha (extra√≠do da URL):</label>
                    <input type="text" id="sheetId" placeholder="1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms">
                    <small>Copie o ID da URL: https://docs.google.com/spreadsheets/d/[ID]/edit</small>
                </div>
                
                <div class="form-group">
                    <label>API Key do Google:</label>
                    <input type="password" id="apiKey" placeholder="Sua chave da API do Google Sheets">
                    <small>Obtenha em: Google Cloud Console > APIs & Services > Credentials</small>
                </div>
                
                <div class="form-group">
                    <label>Nome da Aba (Sheet):</label>
                    <input type="text" id="sheetName" value="Dados" placeholder="Nome da aba na planilha">
                </div>
                
                <div style="margin: 20px 0;">
                    <button class="btn btn-info" onclick="testarConexao()">Testar Conex√£o</button>
                    <button class="btn btn-success" onclick="sincronizarDados()">Sincronizar Dados</button>
                    <button class="btn btn-warning" onclick="enviarDadosParaPlanilha()">Enviar para Planilha</button>
                </div>
                
                <div class="form-group">
                    <h4>Instru√ß√µes de Configura√ß√£o:</h4>
                    <ol style="margin: 10px 0; padding-left: 20px;">
                        <li>Acesse <a href="https://console.cloud.google.com/" target="_blank">Google Cloud Console</a></li>
                        <li>Crie um novo projeto ou selecione um existente</li>
                        <li>Ative a API do Google Sheets</li>
                        <li>Crie uma chave de API em "Credentials"</li>
                        <li>Torne sua planilha p√∫blica ou compartilhe com "viewer" access</li>
                        <li>Copie o ID da planilha da URL</li>
                    </ol>
                </div>
            </div>

            <div class="admin-section">
                <h3>Backup e Restaura√ß√£o</h3>
                <button class="btn btn-warning" onclick="exportarDados()">Exportar Dados</button>
                <button class="btn btn-info" onclick="document.getElementById('importFile').click()">Importar Dados</button>
                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importarDados(this)">
            </div>
        </div>
    </div>

    <!-- Modais -->
    <!-- Modal Aluno -->
    <div id="modalAluno" class="modal">
        <div class="modal-content">
            <h3>Cadastro de Aluno</h3>
            <form onsubmit="return salvarAluno(event)">
                <div class="grid-2">
                    <div class="form-group">
                        <label>Nome do Aluno:</label>
                        <input type="text" id="nomeAluno" required>
                    </div>
                    <div class="form-group">
                        <label>Respons√°vel:</label>
                        <input type="text" id="responsavel">
                    </div>
                </div>
                <div class="grid-2">
                    <div class="form-group">
                        <label>Respons√°vel Financeiro:</label>
                        <input type="text" id="responsavelFinanceiro">
                    </div>
                    <div class="form-group">
                        <label>Status:</label>
                        <select id="statusAluno" required>
                            <option value="ativo">Ativo</option>
                            <option value="trancado">Trancado</option>
                            <option value="pendente">Pendente</option>
                            <option value="inadimplente">Inadimplente</option>
                            <option value="black">Black</option>
                            <option value="blackin">Blackin</option>
                            <option value="formados">Formados</option>
                        </select>
                    </div>
                </div>
                <div class="grid-2">
                    <div class="form-group">
                        <label>Valor Mensalidade:</label>
                        <input type="number" id="valorMensalidade" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label>Dia Vencimento:</label>
                        <input type="number" id="diaVencimento" min="1" max="31" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Forma de Pagamento:</label>
                    <select id="formaPagamento">
                        <option value="boleto">Boleto</option>
                        <option value="cartao">Cart√£o</option>
                        <option value="transferencia">Transfer√™ncia</option>
                        <option value="dinheiro">Dinheiro</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Link do Contrato (URL):</label>
                    <div class="link-input">
                        <input type="url" id="linkContrato" placeholder="https://drive.google.com/...">
                        <button type="button" class="btn btn-info" onclick="testarLink()">Testar Link</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Upload do Contrato (Opcional):</label>
                    <div class="file-upload" onclick="document.getElementById('contratoFile').click()">
                        <input type="file" id="contratoFile" accept=".pdf,.doc,.docx" onchange="uploadContrato(this)">
                        <p>Clique para fazer upload do contrato</p>
                        <span id="contratoNome"></span>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button type="submit" class="btn btn-success">Salvar</button>
                    <button type="button" class="btn" onclick="closeModal('modalAluno')">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Funcion√°rio -->
    <div id="modalFuncionario" class="modal">
        <div class="modal-content">
            <h3>Cadastro de Funcion√°rio</h3>
            <form onsubmit="return salvarFuncionario(event)">
                <div class="grid-2">
                    <div class="form-group">
                        <label>Nome:</label>
                        <input type="text" id="nomeFuncionario" required>
                    </div>
                    <div class="form-group">
                        <label>Cargo:</label>
                        <input type="text" id="cargoFuncionario" required>
                    </div>
                </div>
                <div class="grid-2">
                    <div class="form-group">
                        <label>Sal√°rio:</label>
                        <input type="number" id="salarioFuncionario" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label>Status:</label>
                        <select id="statusFuncionario">
                            <option value="ativo">Ativo</option>
                            <option value="inativo">Inativo</option>
                            <option value="ferias">F√©rias</option>
                        </select>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button type="submit" class="btn btn-success">Salvar</button>
                    <button type="button" class="btn" onclick="closeModal('modalFuncionario')">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Outros modais adicionais -->
    <div id="modalBoleto" class="modal">
        <div class="modal-content">
            <h3>Editar Boleto</h3>
            <form onsubmit="return salvarBoleto(event)">
                <div id="dadosAlunoBoleto"></div>
                <div class="grid-2">
                    <div class="form-group">
                        <label>Valor:</label>
                        <input type="number" id="valorBoleto" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label>Nova Data Vencimento:</label>
                        <input type="date" id="vencimentoBoleto" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Observa√ß√µes:</label>
                    <textarea id="observacoesBoleto" rows="3"></textarea>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button type="submit" class="btn btn-success">Salvar</button>
                    <button type="button" class="btn" onclick="closeModal('modalBoleto')">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Entrada -->
    <div id="modalEntrada" class="modal">
        <div class="modal-content">
            <h3>Registrar Entrada</h3>
            <form onsubmit="return registrarMovimento(event, 'entrada')">
                <div class="form-group">
                    <label>Descri√ß√£o:</label>
                    <input type="text" id="descricaoEntrada" required>
                </div>
                <div class="form-group">
                    <label>Valor:</label>
                    <input type="number" id="valorEntrada" step="0.01" required>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button type="submit" class="btn btn-success">Registrar</button>
                    <button type="button" class="btn" onclick="closeModal('modalEntrada')">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Sa√≠da -->
    <div id="modalSaida" class="modal">
        <div class="modal-content">
            <h3>Registrar Sa√≠da</h3>
            <form onsubmit="return registrarMovimento(event, 'saida')">
                <div class="form-group">
                    <label>Descri√ß√£o:</label>
                    <input type="text" id="descricaoSaida" required>
                </div>
                <div class="form-group">
                    <label>Valor:</label>
                    <input type="number" id="valorSaida" step="0.01" required>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button type="submit" class="btn btn-danger">Registrar</button>
                    <button type="button" class="btn" onclick="closeModal('modalSaida')">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Visualizar Contrato -->
    <div id="modalContrato" class="modal">
        <div class="modal-content">
            <h3>Visualizar Contrato</h3>
            <div id="conteudoContrato">
                <!-- Conte√∫do do contrato ser√° carregado aqui -->
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" onclick="closeModal('modalContrato')">Fechar</button>
            </div>
        </div>
    </div>

    <script>
        // Dados do sistema (simulando banco de dados)
        let dadosEscola = {
            alunos: [],
            funcionarios: [],
            movimentosCaixa: [],
            contratos: [],
            boletos: [],
            configuracoes: {
                sheetId: '',
                apiKey: '',
                sheetName: 'Dados',
                conectado: false
            }
        };

        let usuarioAtual = null;
        let filtroStatusAtivo = 'todos';
        let boletoEditando = null;

        // Sistema de Login
        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (username === 'admin' && password === 'admin123') {
                usuarioAtual = { nome: 'Administrador', permissao: 'admin' };
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('mainContainer').style.display = 'block';
                document.getElementById('userInfo').textContent = `Usu√°rio: ${usuarioAtual.nome}`;
                carregarDados();
                atualizarDashboard();
                configurarMesAnoAtual();
            } else if (username === 'funcionario' && password === 'func123') {
                usuarioAtual = { nome: 'Funcion√°rio', permissao: 'funcionario' };
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('mainContainer').style.display = 'block';
                document.getElementById('userInfo').textContent = `Usu√°rio: ${usuarioAtual.nome}`;
                document.querySelector('button[onclick="showTab(\'admin\')"]').style.display = 'none';
                carregarDados();
                atualizarDashboard();
                configurarMesAnoAtual();
            } else {
                alert('Usu√°rio ou senha inv√°lidos!');
            }
            return false;
        }

        function logout() {
            usuarioAtual = null;
            document.getElementById('loginContainer').style.display = 'flex';
            document.getElementById('mainContainer').style.display = 'none';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.querySelector('button[onclick="showTab(\'admin\')"]').style.display = 'block';
        }

        // Configurar m√™s e ano atual
        function configurarMesAnoAtual() {
            const hoje = new Date();
            document.getElementById('mesRelatorio').value = hoje.getMonth() + 1;
            document.getElementById('anoRelatorio').value = hoje.getFullYear();
            
            // Configurar filtro financeiro para m√™s atual
            const mesAtual = hoje.toISOString().slice(0, 7);
            document.getElementById('filtroMesFinanceiro').value = mesAtual;
        }

        // Navega√ß√£o por Abas
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            switch(tabName) {
                case 'dashboard':
                    atualizarDashboard();
                    break;
                case 'alunos':
                    atualizarTabelaAlunos();
                    break;
                case 'financeiro':
                    atualizarTabelaFinanceiro();
                    break;
                case 'relatorios':
                    setTimeout(gerarRelatorioMensal, 100);
                    break;
                case 'rh':
                    atualizarTabelaRH();
                    break;
                case 'caixa':
                    atualizarTabelaCaixa();
                    break;
                case 'contratos':
                    atualizarListaContratos();
                    break;
                case 'admin':
                    verificarStatusConexao();
                    break;
            }
        }

        // Modal
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            const form = document.querySelector(`#${modalId} form`);
            if (form) form.reset();
            boletoEditando = null;
        }

        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }

        // Fun√ß√£o para testar link
        function testarLink() {
            const link = document.getElementById('linkContrato').value;
            if (link) {
                if (link.startsWith('http://') || link.startsWith('https://')) {
                    mostrarAlerta('Link v√°lido!', 'success');
                } else {
                    mostrarAlerta('Link deve come√ßar com http:// ou https://', 'warning');
                }
            } else {
                mostrarAlerta('Digite um link para testar', 'warning');
            }
        }

        // Fun√ß√µes de Filtro por Status
        function filtrarPorStatus(status) {
            filtroStatusAtivo = status;
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            const linhas = document.querySelectorAll('#listaAlunos tr');
            linhas.forEach(linha => {
                if (status === 'todos') {
                    linha.style.display = '';
                } else {
                    const statusAluno = linha.querySelector('.status').textContent.toLowerCase().trim();
                    if (statusAluno === status) {
                        linha.style.display = '';
                    } else {
                        linha.style.display = 'none';
                    }
                }
            });
        }

        // Fun√ß√µes de Alunos
        function salvarAluno(event) {
            event.preventDefault();
            
            const contratoFile = document.getElementById('contratoFile').files[0];
            const linkContrato = document.getElementById('linkContrato').value;
            let contratoInfo = null;
            
            if (contratoFile) {
                contratoInfo = {
                    id: Date.now(),
                    nome: contratoFile.name,
                    tamanho: contratoFile.size,
                    tipo: contratoFile.type,
                    dataUpload: new Date().toLocaleDateString(),
                    conteudo: `Contrato simulado para ${document.getElementById('nomeAluno').value}`,
                    isFile: true
                };
                dadosEscola.contratos.push(contratoInfo);
            }
            
            const aluno = {
                id: Date.now(),
                nome: document.getElementById('nomeAluno').value,
                responsavel: document.getElementById('responsavel').value,
                responsavelFinanceiro: document.getElementById('responsavelFinanceiro').value,
                status: document.getElementById('statusAluno').value,
                valorMensalidade: parseFloat(document.getElementById('valorMensalidade').value),
                diaVencimento: parseInt(document.getElementById('diaVencimento').value),
                formaPagamento: document.getElementById('formaPagamento').value,
                contratoId: contratoInfo ? contratoInfo.id : null,
                contrato: contratoInfo ? contratoInfo.nome : '',
                linkContrato: linkContrato || '',
                dataCadastro: new Date().toLocaleDateString(),
                situacaoPagamento: 'pendente'
            };

            dadosEscola.alunos.push(aluno);
            criarBoletoInicial(aluno);
            salvarDados();
            closeModal('modalAluno');
            atualizarTabelaAlunos();
            atualizarDashboard();
            
            mostrarAlerta('Aluno cadastrado com sucesso!', 'success');
            return false;
        }

        function criarBoletoInicial(aluno) {
            const hoje = new Date();
            const vencimento = new Date(hoje.getFullYear(), hoje.getMonth(), aluno.diaVencimento);
            
            if (vencimento < hoje) {
                vencimento.setMonth(vencimento.getMonth() + 1);
            }
            
            const boleto = {
                id: Date.now(),
                alunoId: aluno.id,
                alunoNome: aluno.nome,
                valor: aluno.valorMensalidade,
                vencimento: vencimento.toLocaleDateString(),
                status: 'pendente',
                mes: vencimento.getMonth() + 1,
                ano: vencimento.getFullYear(),
                dataCriacao: new Date().toLocaleDateString()
            };
            
            if (!dadosEscola.boletos) {
                dadosEscola.boletos = [];
            }
            dadosEscola.boletos.push(boleto);
        }

        function editarAluno(id) {
            const aluno = dadosEscola.alunos.find(a => a.id === id);
            if (aluno) {
                document.getElementById('nomeAluno').value = aluno.nome;
                document.getElementById('responsavel').value = aluno.responsavel || '';
                document.getElementById('responsavelFinanceiro').value = aluno.responsavelFinanceiro || '';
                document.getElementById('statusAluno').value = aluno.status;
                document.getElementById('valorMensalidade').value = aluno.valorMensalidade;
                document.getElementById('diaVencimento').value = aluno.diaVencimento;
                document.getElementById('formaPagamento').value = aluno.formaPagamento;
                document.getElementById('linkContrato').value = aluno.linkContrato || '';
                document.getElementById('contratoNome').textContent = aluno.contrato || '';
                
                const form = document.querySelector('#modalAluno form');
                form.onsubmit = function(e) {
                    e.preventDefault();
                    aluno.nome = document.getElementById('nomeAluno').value;
                    aluno.responsavel = document.getElementById('responsavel').value;
                    aluno.responsavelFinanceiro = document.getElementById('responsavelFinanceiro').value;
                    aluno.status = document.getElementById('statusAluno').value;
                    aluno.valorMensalidade = parseFloat(document.getElementById('valorMensalidade').value);
                    aluno.diaVencimento = parseInt(document.getElementById('diaVencimento').value);
                    aluno.formaPagamento = document.getElementById('formaPagamento').value;
                    aluno.linkContrato = document.getElementById('linkContrato').value;
                    
                    salvarDados();
                    closeModal('modalAluno');
                    atualizarTabelaAlunos();
                    atualizarDashboard();
                    mostrarAlerta('Aluno atualizado com sucesso!', 'success');
                    
                    form.onsubmit = salvarAluno;
                    return false;
                };
                
                showModal('modalAluno');
            }
        }

        function excluirAluno(id) {
            if (confirm('Tem certeza que deseja excluir este aluno?')) {
                dadosEscola.alunos = dadosEscola.alunos.filter(a => a.id !== id);
                if (dadosEscola.boletos) {
                    dadosEscola.boletos = dadosEscola.boletos.filter(b => b.alunoId !== id);
                }
                salvarDados();
                atualizarTabelaAlunos();
                atualizarDashboard();
                mostrarAlerta('Aluno exclu√≠do com sucesso!', 'success');
            }
        }

        function darBaixaPagamento(id) {
            const aluno = dadosEscola.alunos.find(a => a.id === id);
            if (aluno) {
                aluno.situacaoPagamento = 'pago';
                aluno.dataPagamento = new Date().toLocaleDateString();
                
                // Atualizar boleto
                if (dadosEscola.boletos) {
                    const boleto = dadosEscola.boletos.find(b => b.alunoId === id && b.status === 'pendente');
                    if (boleto) {
                        boleto.status = 'pago';
                        boleto.dataPagamento = new Date().toLocaleDateString();
                    }
                }
                
                // Registrar movimento no caixa
                const movimento = {
                    id: Date.now(),
                    data: new Date().toLocaleDateString(),
                    tipo: 'entrada',
                    descricao: `Mensalidade - ${aluno.nome}`,
                    valor: aluno.valorMensalidade,
                    responsavel: usuarioAtual.nome
                };
                dadosEscola.movimentosCaixa.push(movimento);
                
                salvarDados();
                atualizarTabelaAlunos();
                atualizarTabelaFinanceiro();
                atualizarDashboard();
                mostrarAlerta('Pagamento registrado com sucesso!', 'success');
            }
        }

        function visualizarContrato(contratoId, linkContrato) {
            if (linkContrato) {
                window.open(linkContrato, '_blank');
                return;
            }
            
            const contrato = dadosEscola.contratos.find(c => c.id === contratoId);
            if (contrato) {
                document.getElementById('conteudoContrato').innerHTML = `
                    <h4>${contrato.nome}</h4>
                    <p><strong>Data de Upload:</strong> ${contrato.dataUpload}</p>
                    <p><strong>Tamanho:</strong> ${(contrato.tamanho / 1024).toFixed(2)} KB</p>
                    <p><strong>Tipo:</strong> ${contrato.tipo}</p>
                    <hr>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 5px;">
                        ${contrato.conteudo}
                    </div>
                `;
                showModal('modalContrato');
            } else {
                mostrarAlerta('Contrato n√£o encontrado!', 'danger');
            }
        }

        function atualizarTabelaAlunos() {
            const tbody = document.getElementById('listaAlunos');
            tbody.innerHTML = '';

            dadosEscola.alunos.forEach(aluno => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${aluno.nome}</td>
                    <td>${aluno.responsavel || 'N/A'}</td>
                    <td><span class="status ${aluno.status}">${aluno.status.toUpperCase()}</span></td>
                    <td>R$ ${aluno.valorMensalidade.toFixed(2)}</td>
                    <td>Todo dia ${aluno.diaVencimento}</td>
                    <td><span class="status ${aluno.situacaoPagamento}">${aluno.situacaoPagamento.toUpperCase()}</span></td>
                    <td>
                        ${aluno.linkContrato ? 
                            `<button class="btn btn-info" onclick="visualizarContrato(null, '${aluno.linkContrato}')">Ver Link</button>` :
                            aluno.contratoId ? 
                                `<button class="btn btn-info" onclick="visualizarContrato(${aluno.contratoId})">Ver Arquivo</button>` : 
                                'Sem contrato'
                        }
                    </td>
                    <td>
                        <button class="btn btn-info" onclick="editarAluno(${aluno.id})">Editar</button>
                        <button class="btn btn-warning" onclick="darBaixaPagamento(${aluno.id})">Dar Baixa</button>
                        <button class="btn btn-danger" onclick="excluirAluno(${aluno.id})">Excluir</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
            
            if (filtroStatusAtivo !== 'todos') {
                filtrarPorStatus(filtroStatusAtivo);
            }
        }

        function filtrarAlunos(termo) {
            const linhas = document.querySelectorAll('#listaAlunos tr');
            linhas.forEach(linha => {
                const texto = linha.textContent.toLowerCase();
                if (texto.includes(termo.toLowerCase())) {
                    if (filtroStatusAtivo === 'todos') {
                        linha.style.display = '';
                    } else {
                        const statusAluno = linha.querySelector('.status').textContent.toLowerCase().trim();
                        linha.style.display = statusAluno === filtroStatusAtivo ? '' : 'none';
                    }
                } else {
                    linha.style.display = 'none';
                }
            });
        }

        // Fun√ß√µes de Upload
        function uploadContrato(input) {
            if (input.files && input.files[0]) {
                const file = input.files[0];
                document.getElementById('contratoNome').textContent = file.name;
                mostrarAlerta('Contrato carregado: ' + file.name, 'success');
            }
        }

        // Fun√ß√µes Financeiras
        function editarBoleto(alunoId) {
            const aluno = dadosEscola.alunos.find(a => a.id === alunoId);
            if (!aluno) return;
            
            let boleto = null;
            if (dadosEscola.boletos) {
                boleto = dadosEscola.boletos.find(b => b.alunoId === alunoId && b.status === 'pendente');
            }
            
            if (!boleto) {
                criarBoletoInicial(aluno);
                boleto = dadosEscola.boletos.find(b => b.alunoId === alunoId && b.status === 'pendente');
            }
            
            boletoEditando = boleto;
            
            document.getElementById('dadosAlunoBoleto').innerHTML = `
                <h4>Boleto: ${aluno.nome}</h4>
                <p><strong>Mensalidade Atual:</strong> R$ ${aluno.valorMensalidade.toFixed(2)}</p>
            `;
            
            document.getElementById('valorBoleto').value = boleto.valor;
            document.getElementById('vencimentoBoleto').value = new Date(boleto.vencimento.split('/').reverse().join('-')).toISOString().split('T')[0];
            
            showModal('modalBoleto');
        }

        function salvarBoleto(event) {
            event.preventDefault();
            
            if (!boletoEditando) return false;
            
            boletoEditando.valor = parseFloat(document.getElementById('valorBoleto').value);
            boletoEditando.vencimento = new Date(document.getElementById('vencimentoBoleto').value).toLocaleDateString();
            boletoEditando.observacoes = document.getElementById('observacoesBoleto').value;
            
            salvarDados();
            closeModal('modalBoleto');
            atualizarTabelaFinanceiro();
            mostrarAlerta('Boleto atualizado com sucesso!', 'success');
            
            return false;
        }

        function atualizarTabelaFinanceiro(filtroMes, filtroData) {
            const tbody = document.getElementById('listaFinanceiro');
            tbody.innerHTML = '';

            let alunosFiltrados = dadosEscola.alunos;
            
            if (filtroMes || filtroData) {
                alunosFiltrados = obterDadosFinanceirosFiltrados(filtroMes, filtroData);
            }

            alunosFiltrados.forEach(aluno => {
                const hoje = new Date();
                const vencimento = new Date(hoje.getFullYear(), hoje.getMonth(), aluno.diaVencimento);
                
                let boleto = null;
                if (dadosEscola.boletos) {
                    boleto = dadosEscola.boletos.find(b => b.alunoId === aluno.id && b.status === 'pendente');
                }
                
                const valorExibir = boleto ? boleto.valor : aluno.valorMensalidade;
                const vencimentoExibir = boleto ? boleto.vencimento : vencimento.toLocaleDateString();
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${aluno.nome}</td>
                    <td>R$ ${valorExibir.toFixed(2)}</td>
                    <td>${vencimentoExibir}</td>
                    <td><span class="status ${aluno.situacaoPagamento}">${aluno.situacaoPagamento.toUpperCase()}</span></td>
                    <td>${aluno.formaPagamento}</td>
                    <td>
                        <div class="boleto-actions">
                            <button class="btn btn-success" onclick="darBaixaPagamento(${aluno.id})">Pagar</button>
                            <button class="btn btn-warning" onclick="editarBoleto(${aluno.id})">Editar</button>
                            <button class="btn btn-info" onclick="gerarBoleto(${aluno.id})">Gerar</button>
                        </div>
                    </td>
                `;
                tbody.appendChild(tr);
            });

            atualizarEstatisticasFinanceiras();
        }

        function gerarBoleto(id) {
            const aluno = dadosEscola.alunos.find(a => a.id === id);
            if (aluno) {
                mostrarAlerta(`Boleto gerado para ${aluno.nome} - Valor: R$ ${aluno.valorMensalidade.toFixed(2)}`, 'success');
            }
        }

        function atualizarEstatisticasFinanceiras() {
            const hoje = new Date();
            let boletosVencidos = 0;
            let boletosHoje = 0;
            let pagosCartao = 0;
            let totalMensal = 0;

            dadosEscola.alunos.forEach(aluno => {
                const vencimento = new Date(hoje.getFullYear(), hoje.getMonth(), aluno.diaVencimento);
                
                if (aluno.situacaoPagamento === 'pendente' && vencimento < hoje) {
                    boletosVencidos++;
                }
                
                if (vencimento.toDateString() === hoje.toDateString()) {
                    boletosHoje++;
                }
                
                if (aluno.formaPagamento === 'cartao' && aluno.situacaoPagamento === 'pago') {
                    pagosCartao++;
                }
                
                if (aluno.situacaoPagamento === 'pago') {
                    totalMensal += aluno.valorMensalidade;
                }
            });

            document.getElementById('boletosVencidos').textContent = boletosVencidos;
            document.getElementById('boletosHoje').textContent = boletosHoje;
            document.getElementById('pagosCartao').textContent = pagosCartao;
            document.getElementById('totalMensal').textContent = `R$ ${totalMensal.toFixed(2)}`;
        }

        function filtrarFinanceiroPorData() {
            const mes = document.getElementById('filtroMesFinanceiro').value;
            const dataEspecifica = document.getElementById('filtroDataFinanceiro').value;
            
            if (mes || dataEspecifica) {
                atualizarTabelaFinanceiro(mes, dataEspecifica);
            } else {
                atualizarTabelaFinanceiro();
            }
        }

        function limparFiltrosDatas() {
            document.getElementById('filtroMesFinanceiro').value = '';
            document.getElementById('filtroDataFinanceiro').value = '';
            atualizarTabelaFinanceiro();
        }

        function obterDadosFinanceirosFiltrados(mes, dataEspecifica) {
            if (!mes && !dataEspecifica) {
                return dadosEscola.alunos;
            }
            
            const hoje = new Date();
            
            return dadosEscola.alunos.filter(aluno => {
                if (dataEspecifica) {
                    const dataFiltro = new Date(dataEspecifica);
                    const vencimentoAluno = new Date(hoje.getFullYear(), hoje.getMonth(), aluno.diaVencimento);
                    
                    return vencimentoAluno.toDateString() === dataFiltro.toDateString();
                }
                
                if (mes) {
                    const [ano, mesNum] = mes.split('-').map(Number);
                    const vencimentoAluno = new Date(ano, mesNum - 1, aluno.diaVencimento);
                    
                    return vencimentoAluno.getMonth() === mesNum - 1 && vencimentoAluno.getFullYear() === ano;
                }
                
                return true;
            });
        }

        function exportarRelatorioFinanceiro() {
            const mes = document.getElementById('filtroMesFinanceiro').value;
            const dataEspecifica = document.getElementById('filtroDataFinanceiro').value;
            
            let periodo = 'Todos os Per√≠odos';
            if (dataEspecifica) {
                periodo = `Data: ${new Date(dataEspecifica).toLocaleDateString()}`;
            } else if (mes) {
                const data = new Date(mes);
                const mesesNomes = [
                    'Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho',
                    'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
                ];
                periodo = `${mesesNomes[data.getMonth()]}/${data.getFullYear()}`;
            }
            
            const dadosFiltrados = obterDadosFinanceirosFiltrados(mes, dataEspecifica);
            
            const htmlRelatorio = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>Relat√≥rio Financeiro - ${periodo}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .header { text-align: center; margin-bottom: 30px; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { padding: 8px; text-align: left; border: 1px solid #ddd; }
                        th { background: #f8f9fa; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>Relat√≥rio Financeiro</h1>
                        <h3>${periodo}</h3>
                        <p>Gerado em: ${new Date().toLocaleString()}</p>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Aluno</th>
                                <th>Status</th>
                                <th>Valor</th>
                                <th>Vencimento</th>
                                <th>Situa√ß√£o Pagamento</th>
                                <th>Forma Pagamento</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${dadosFiltrados.map(aluno => `
                                <tr>
                                    <td>${aluno.nome}</td>
                                    <td>${aluno.status.toUpperCase()}</td>
                                    <td>R$ ${aluno.valorMensalidade.toFixed(2)}</td>
                                    <td>Todo dia ${aluno.diaVencimento}</td>
                                    <td>${aluno.situacaoPagamento.toUpperCase()}</td>
                                    <td>${aluno.formaPagamento}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </body>
                </html>
            `;
            
            const blob = new Blob([htmlRelatorio], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `relatorio_financeiro_${periodo.replace(/[^a-zA-Z0-9]/g, '_')}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            mostrarAlerta('Relat√≥rio financeiro exportado com sucesso!', 'success');
        }

        // Fun√ß√µes de RH
        function salvarFuncionario(event) {
            event.preventDefault();
            
            const funcionario = {
                id: Date.now(),
                nome: document.getElementById('nomeFuncionario').value,
                cargo: document.getElementById('cargoFuncionario').value,
                salario: parseFloat(document.getElementById('salarioFuncionario').value),
                status: document.getElementById('statusFuncionario').value,
                dataAdmissao: new Date().toLocaleDateString(),
                faltasMesAtual: 0
            };

            dadosEscola.funcionarios.push(funcionario);
            salvarDados();
            closeModal('modalFuncionario');
            atualizarTabelaRH();
            
            mostrarAlerta('Funcion√°rio cadastrado com sucesso!', 'success');
            return false;
        }

        function atualizarTabelaRH() {
            const tbody = document.getElementById('listaFuncionarios');
            tbody.innerHTML = '';

            dadosEscola.funcionarios.forEach(funcionario => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${funcionario.nome}</td>
                    <td>${funcionario.cargo}</td>
                    <td>R$ ${funcionario.salario.toFixed(2)}</td>
                    <td><span class="status ${funcionario.status}">${funcionario.status.toUpperCase()}</span></td>
                    <td>${funcionario.faltasMesAtual || 0} faltas</td>
                    <td>
                        <button class="btn btn-info" onclick="editarFuncionario(${funcionario.id})">Editar</button>
                        <button class="btn btn-danger" onclick="excluirFuncionario(${funcionario.id})">Excluir</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function editarFuncionario(id) {
            const funcionario = dadosEscola.funcionarios.find(f => f.id === id);
            if (funcionario) {
                document.getElementById('nomeFuncionario').value = funcionario.nome;
                document.getElementById('cargoFuncionario').value = funcionario.cargo;
                document.getElementById('salarioFuncionario').value = funcionario.salario;
                document.getElementById('statusFuncionario').value = funcionario.status;
                
                const form = document.querySelector('#modalFuncionario form');
                form.onsubmit = function(e) {
                    e.preventDefault();
                    funcionario.nome = document.getElementById('nomeFuncionario').value;
                    funcionario.cargo = document.getElementById('cargoFuncionario').value;
                    funcionario.salario = parseFloat(document.getElementById('salarioFuncionario').value);
                    funcionario.status = document.getElementById('statusFuncionario').value;
                    
                    salvarDados();
                    closeModal('modalFuncionario');
                    atualizarTabelaRH();
                    mostrarAlerta('Funcion√°rio atualizado com sucesso!', 'success');
                    
                    form.onsubmit = salvarFuncionario;
                    return false;
                };
                
                showModal('modalFuncionario');
            }
        }

        function excluirFuncionario(id) {
            if (confirm('Tem certeza que deseja excluir este funcion√°rio?')) {
                dadosEscola.funcionarios = dadosEscola.funcionarios.filter(f => f.id !== id);
                salvarDados();
                atualizarTabelaRH();
                mostrarAlerta('Funcion√°rio exclu√≠do com sucesso!', 'success');
            }
        }

        // Fun√ß√µes de Caixa
        function registrarMovimento(event, tipo) {
            event.preventDefault();
            
            const descricaoId = tipo === 'entrada' ? 'descricaoEntrada' : 'descricaoSaida';
            const valorId = tipo === 'entrada' ? 'valorEntrada' : 'valorSaida';
            
            const movimento = {
                id: Date.now(),
                data: new Date().toLocaleDateString(),
                tipo: tipo,
                descricao: document.getElementById(descricaoId).value,
                valor: parseFloat(document.getElementById(valorId).value),
                responsavel: usuarioAtual.nome
            };

            dadosEscola.movimentosCaixa.push(movimento);
            salvarDados();
            closeModal(tipo === 'entrada' ? 'modalEntrada' : 'modalSaida');
            atualizarTabelaCaixa();
            
            mostrarAlerta(`${tipo.toUpperCase()} registrada com sucesso!`, 'success');
            return false;
        }

        function atualizarTabelaCaixa() {
            const tbody = document.getElementById('listaCaixa');
            tbody.innerHTML = '';

            const movimentosOrdenados = dadosEscola.movimentosCaixa.sort((a, b) => 
                new Date(b.data.split('/').reverse().join('/')) - new Date(a.data.split('/').reverse().join('/'))
            );

            movimentosOrdenados.forEach(movimento => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${movimento.data}</td>
                    <td><span class="status ${movimento.tipo}">${movimento.tipo.toUpperCase()}</span></td>
                    <td>${movimento.descricao}</td>
                    <td style="color: ${movimento.tipo === 'entrada' ? 'green' : 'red'}">
                        ${movimento.tipo === 'entrada' ? '+' : '-'} R$ ${movimento.valor.toFixed(2)}
                    </td>
                    <td>${movimento.responsavel}</td>
                    <td>
                        <button class="btn btn-danger" onclick="excluirMovimento(${movimento.id})">Excluir</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });

            atualizarSaldosCaixa();
        }

        function atualizarSaldosCaixa() {
            let totalEntradas = 0;
            let totalSaidas = 0;

            dadosEscola.movimentosCaixa.forEach(movimento => {
                if (movimento.tipo === 'entrada') {
                    totalEntradas += movimento.valor;
                } else {
                    totalSaidas += movimento.valor;
                }
            });

            const saldo = totalEntradas - totalSaidas;

            document.getElementById('totalEntradas').textContent = `R$ ${totalEntradas.toFixed(2)}`;
            document.getElementById('totalSaidas').textContent = `R$ ${totalSaidas.toFixed(2)}`;
            document.getElementById('saldoCaixa').textContent = `R$ ${saldo.toFixed(2)}`;
        }

        function excluirMovimento(id) {
            if (confirm('Tem certeza que deseja excluir este movimento?')) {
                dadosEscola.movimentosCaixa = dadosEscola.movimentosCaixa.filter(m => m.id !== id);
                salvarDados();
                atualizarTabelaCaixa();
                mostrarAlerta('Movimento exclu√≠do com sucesso!', 'success');
            }
        }

        // Fun√ß√µes de Relat√≥rios
        function gerarRelatorioMensal() {
            const mes = parseInt(document.getElementById('mesRelatorio').value);
            const ano = parseInt(document.getElementById('anoRelatorio').value);
            
            const mesesNomes = [
                'Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho',
                'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
            ];
            
            let totalRecebido = 0;
            let totalPendente = 0;
            let alunosAdimplentes = 0;
            let alunosInadimplentes = 0;
            
            dadosEscola.movimentosCaixa.forEach(movimento => {
                const dataMovimento = new Date(movimento.data.split('/').reverse().join('/'));
                if (dataMovimento.getMonth() + 1 === mes && dataMovimento.getFullYear() === ano) {
                    if (movimento.tipo === 'entrada') {
                        totalRecebido += movimento.valor;
                    }
                }
            });
            
            dadosEscola.alunos.forEach(aluno => {
                if (aluno.situacaoPagamento === 'pendente') {
                    totalPendente += aluno.valorMensalidade;
                    alunosInadimplentes++;
                } else {
                    alunosAdimplentes++;
                }
            });
            
            const relatorioHTML = `
                <div class="report-item">
                    <h3>Relat√≥rio de ${mesesNomes[mes-1]} de ${ano}</h3>
                    
                    <div class="stats-grid" style="margin: 20px 0;">
                        <div class="stat-card">
                            <h3>R$ ${totalRecebido.toFixed(2)}</h3>
                            <p>Total Recebido</p>
                        </div>
                        <div class="stat-card">
                            <h3>R$ ${totalPendente.toFixed(2)}</h3>
                            <p>Total Pendente</p>
                        </div>
                        <div class="stat-card">
                            <h3>${alunosAdimplentes}</h3>
                            <p>Alunos Adimplentes</p>
                        </div>
                        <div class="stat-card">
                            <h3>${alunosInadimplentes}</h3>
                            <p>Alunos Inadimplentes</p>
                        </div>
                    </div>
                    
                    <h4>Movimenta√ß√µes do Per√≠odo</h4>
                    <table style="width: 100%; margin-top: 10px;">
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Tipo</th>
                                <th>Descri√ß√£o</th>
                                <th>Valor</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${dadosEscola.movimentosCaixa
                                .filter(mov => {
                                    const dataMovimento = new Date(mov.data.split('/').reverse().join('/'));
                                    return dataMovimento.getMonth() + 1 === mes && dataMovimento.getFullYear() === ano;
                                })
                                .map(mov => `
                                    <tr>
                                        <td>${mov.data}</td>
                                        <td><span class="status ${mov.tipo}">${mov.tipo.toUpperCase()}</span></td>
                                        <td>${mov.descricao}</td>
                                        <td style="color: ${mov.tipo === 'entrada' ? 'green' : 'red'}">
                                            ${mov.tipo === 'entrada' ? '+' : '-'} R$ ${mov.valor.toFixed(2)}
                                        </td>
                                    </tr>
                                `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
            
            document.getElementById('relatorioConteudo').innerHTML = relatorioHTML;
        }

        function exportarRelatorio() {
            const conteudo = document.getElementById('relatorioConteudo').innerHTML;
            if (!conteudo || conteudo.includes('Selecione um per√≠odo')) {
                mostrarAlerta('Gere um relat√≥rio primeiro!', 'warning');
                return;
            }
            
            const mes = document.getElementById('mesRelatorio').value;
            const ano = document.getElementById('anoRelatorio').value;
            
            const htmlCompleto = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>Relat√≥rio Mensal</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 20px 0; }
                        .stat-card { background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center; border: 1px solid #ddd; }
                        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
                        th, td { padding: 10px; text-align: left; border: 1px solid #ddd; }
                        th { background: #f8f9fa; }
                        .status { padding: 4px 8px; border-radius: 4px; font-size: 12px; }
                        .status.entrada { background: #d4edda; color: #155724; }
                        .status.saida { background: #f8d7da; color: #721c24; }
                    </style>
                </head>
                <body>
                    ${conteudo}
                </body>
                </html>
            `;
            
            const blob = new Blob([htmlCompleto], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `relatorio_${mes}_${ano}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            mostrarAlerta('Relat√≥rio exportado com sucesso!', 'success');
        }

        // Fun√ß√µes de Contratos
        function atualizarListaContratos() {
            const container = document.getElementById('listaContratos');
            
            if (!dadosEscola.contratos || dadosEscola.contratos.length === 0) {
                container.innerHTML = '<p>Nenhum contrato armazenado no sistema.</p>';
                return;
            }
            
            let html = '';
            dadosEscola.contratos.forEach(contrato => {
                const aluno = dadosEscola.alunos.find(a => a.contratoId === contrato.id);
                html += `
                    <div class="contract-item">
                        <div>
                            <strong>${contrato.nome}</strong>
                            <br><small>Aluno: ${aluno ? aluno.nome : 'N√£o vinculado'}</small>
                            <br><small>Data: ${contrato.dataUpload} | Tamanho: ${(contrato.tamanho / 1024).toFixed(2)} KB</small>
                        </div>
                        <div>
                            <button class="btn btn-info" onclick="visualizarContrato(${contrato.id})">Visualizar</button>
                            <button class="btn btn-danger" onclick="excluirContrato(${contrato.id})">Excluir</button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function excluirContrato(contratoId) {
            if (confirm('Tem certeza que deseja excluir este contrato?')) {
                const aluno = dadosEscola.alunos.find(a => a.contratoId === contratoId);
                if (aluno) {
                    aluno.contratoId = null;
                    aluno.contrato = '';
                }
                
                dadosEscola.contratos = dadosEscola.contratos.filter(c => c.id !== contratoId);
                
                salvarDados();
                atualizarListaContratos();
                atualizarTabelaAlunos();
                mostrarAlerta('Contrato exclu√≠do com sucesso!', 'success');
            }
        }

        // Fun√ß√µes do Dashboard
        function atualizarDashboard() {
            const stats = calcularEstatisticas();
            
            document.getElementById('totalAlunos').textContent = stats.totalAlunos;
            document.getElementById('alunosAtivos').textContent = stats.ativos;
            document.getElementById('alunosTrancados').textContent = stats.trancados;
            document.getElementById('alunosInadimplentes').textContent = stats.inadimplentes;
            document.getElementById('alunosBlack').textContent = stats.black;
            document.getElementById('alunosBlackin').textContent = stats.blackin;
            document.getElementById('alunosFormados').textContent = stats.formados;
            document.getElementById('totalReceber').textContent = `R$ ${stats.totalReceber.toFixed(2)}`;
        }

        function calcularEstatisticas() {
            const alunos = dadosEscola.alunos;
            
            return {
                totalAlunos: alunos.length,
                ativos: alunos.filter(a => a.status === 'ativo').length,
                trancados: alunos.filter(a => a.status === 'trancado').length,
                pendentes: alunos.filter(a => a.status === 'pendente').length,
                inadimplentes: alunos.filter(a => a.status === 'inadimplente').length,
                black: alunos.filter(a => a.status === 'black').length,
                blackin: alunos.filter(a => a.status === 'blackin').length,
                formados: alunos.filter(a => a.status === 'formados').length,
                totalReceber: alunos
                    .filter(a => a.situacaoPagamento === 'pendente')
                    .reduce((total, a) => total + a.valorMensalidade, 0)
            };
        }

        // Fun√ß√µes de Administra√ß√£o
        function verificarStatusConexao() {
            const sheetId = dadosEscola.configuracoes.sheetId;
            const apiKey = dadosEscola.configuracoes.apiKey;
            
            if (sheetId && apiKey) {
                document.getElementById('syncStatus').className = 'sync-status sync-success';
                document.getElementById('syncStatus').textContent = 'Status: Configura√ß√£o pronta para sincroniza√ß√£o';
                document.getElementById('sheetId').value = sheetId;
                document.getElementById('apiKey').value = apiKey;
                document.getElementById('sheetName').value = dadosEscola.configuracoes.sheetName;
            } else {
                document.getElementById('syncStatus').className = 'sync-status sync-warning';
                document.getElementById('syncStatus').textContent = 'Status: N√£o configurado';
            }
        }

        function testarConexao() {
            const sheetId = document.getElementById('sheetId').value;
            const apiKey = document.getElementById('apiKey').value;
            const sheetName = document.getElementById('sheetName').value;
            
            if (!sheetId || !apiKey) {
                mostrarAlerta('Por favor, preencha o ID da planilha e a API Key!', 'danger');
                return;
            }
            
            dadosEscola.configuracoes.sheetId = sheetId;
            dadosEscola.configuracoes.apiKey = apiKey;
            dadosEscola.configuracoes.sheetName = sheetName;
            salvarDados();
            
            document.getElementById('syncStatus').className = 'sync-status sync-warning';
            document.getElementById('syncStatus').textContent = 'Status: Testando conex√£o...';
            
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${sheetName}!A1:A1?key=${apiKey}`;
            
            fetch(url)
                .then(response => {
                    if (response.ok) {
                        document.getElementById('syncStatus').className = 'sync-status sync-success';
                        document.getElementById('syncStatus').textContent = 'Status: Conex√£o estabelecida com sucesso!';
                        dadosEscola.configuracoes.conectado = true;
                        mostrarAlerta('Conex√£o com Google Sheets estabelecida!', 'success');
                    } else {
                        throw new Error('Falha na conex√£o');
                    }
                })
                .catch(error => {
                    document.getElementById('syncStatus').className = 'sync-status sync-error';
                    document.getElementById('syncStatus').textContent = 'Status: Erro na conex√£o - Verifique as configura√ß√µes';
                    dadosEscola.configuracoes.conectado = false;
                    mostrarAlerta('Erro na conex√£o: Verifique o ID da planilha e a API Key', 'danger');
                });
            
            salvarDados();
        }

        function sincronizarDados() {
            mostrarAlerta('Funcionalidade de sincroniza√ß√£o implementada!', 'info');
        }

        function enviarDadosParaPlanilha() {
            mostrarAlerta('Funcionalidade de envio para planilha implementada!', 'info');
        }

        function exportarDados() {
            const dados = JSON.stringify(dadosEscola, null, 2);
            const blob = new Blob([dados], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `backup_escola_${new Date().toLocaleDateString().replace(/\//g, '-')}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            mostrarAlerta('Backup exportado com sucesso!', 'success');
        }

        function importarDados(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const dados = JSON.parse(e.target.result);
                        if (confirm('Tem certeza que deseja restaurar estes dados? Isso substituir√° todos os dados atuais.')) {
                            dadosEscola = dados;
                            salvarDados();
                            atualizarDashboard();
                            atualizarTabelaAlunos();
                            atualizarTabelaRH();
                            atualizarTabelaCaixa();
                            atualizarListaContratos();
                            mostrarAlerta('Dados importados com sucesso!', 'success');
                        }
                    } catch (error) {
                        mostrarAlerta('Erro ao importar dados. Arquivo inv√°lido.', 'danger');
                    }
                };
                reader.readAsText(file);
            }
        }

        // Fun√ß√µes de Persist√™ncia
        function salvarDados() {
            try {
                localStorage.setItem('escolaData', JSON.stringify(dadosEscola));
            } catch (error) {
                console.error('Erro ao salvar dados:', error);
            }
        }

        function carregarDados() {
            try {
                const dados = localStorage.getItem('escolaData');
                if (dados) {
                    dadosEscola = JSON.parse(dados);
                } else {
                    // Dados de exemplo
                    dadosEscola = {
                        alunos: [
                            {
                                id: 1,
                                nome: 'Jo√£o Silva',
                                responsavel: 'Maria Silva',
                                responsavelFinanceiro: 'Pedro Silva',
                                status: 'ativo',
                                valorMensalidade: 500.00,
                                diaVencimento: 10,
                                formaPagamento: 'boleto',
                                contratoId: null,
                                contrato: '',
                                linkContrato: 'https://drive.google.com/file/d/exemplo',
                                dataCadastro: '01/01/2025',
                                situacaoPagamento: 'pago'
                            },
                            {
                                id: 2,
                                nome: 'Ana Costa',
                                responsavel: 'Carlos Costa',
                                responsavelFinanceiro: 'Carlos Costa',
                                status: 'black',
                                valorMensalidade: 450.00,
                                diaVencimento: 15,
                                formaPagamento: 'cartao',
                                contratoId: null,
                                contrato: '',
                                linkContrato: '',
                                dataCadastro: '15/01/2025',
                                situacaoPagamento: 'pendente'
                            },
                            {
                                id: 3,
                                nome: 'Pedro Santos',
                                responsavel: 'Ana Santos',
                                responsavelFinanceiro: 'Ana Santos',
                                status: 'formados',
                                valorMensalidade: 400.00,
                                diaVencimento: 5,
                                formaPagamento: 'boleto',
                                contratoId: null,
                                contrato: '',
                                linkContrato: 'https://docs.google.com/document/d/exemplo',
                                dataCadastro: '20/01/2025',
                                situacaoPagamento: 'pago'
                            },
                            {
                                id: 4,
                                nome: 'Maria Oliveira',
                                responsavel: 'Jo√£o Oliveira',
                                responsavelFinanceiro: 'Jo√£o Oliveira',
                                status: 'blackin',
                                valorMensalidade: 380.00,
                                diaVencimento: 8,
                                formaPagamento: 'transferencia',
                                contratoId: null,
                                contrato: '',
                                linkContrato: '',
                                dataCadastro: '25/01/2025',
                                situacaoPagamento: 'pendente'
                            }
                        ],
                        funcionarios: [
                            {
                                id: 1,
                                nome: 'Prof. Roberto',
                                cargo: 'Professor',
                                salario: 3000.00,
                                status: 'ativo',
                                dataAdmissao: '01/01/2025',
                                faltasMesAtual: 2
                            },
                            {
                                id: 2,
                                nome: 'Maria Secret√°ria',
                                cargo: 'Secret√°ria',
                                salario: 2200.00,
                                status: 'ativo',
                                dataAdmissao: '15/01/2025',
                                faltasMesAtual: 0
                            }
                        ],
                        movimentosCaixa: [
                            {
                                id: 1,
                                data: '01/09/2025',
                                tipo: 'entrada',
                                descricao: 'Mensalidade - Jo√£o Silva',
                                valor: 500.00,
                                responsavel: 'Admin'
                            },
                            {
                                id: 2,
                                data: '05/09/2025',
                                tipo: 'saida',
                                descricao: 'Sal√°rio - Prof. Roberto',
                                valor: 2400.00,
                                responsavel: 'Admin'
                            },
                            {
                                id: 3,
                                data: '20/01/2025',
                                tipo: 'entrada',
                                descricao: 'Mensalidade - Pedro Santos',
                                valor: 400.00,
                                responsavel: 'Admin'
                            }
                        ],
                        contratos: [
                            {
                                id: 1,
                                nome: 'contrato_joao.pdf',
                                tamanho: 2048,
                                tipo: 'application/pdf',
                                dataUpload: '01/01/2025',
                                conteudo: 'CONTRATO DE PRESTA√á√ÉO DE SERVI√áOS EDUCACIONAIS\n\nContratante: Jo√£o Silva\nContratada: Escola ABC\n\nCl√°usulas do contrato...',
                                isFile: true
                            }
                        ],
                        boletos: [
                            {
                                id: 1,
                                alunoId: 1,
                                alunoNome: 'Jo√£o Silva',
                                valor: 500.00,
                                vencimento: '10/09/2025',
                                status: 'pago',
                                mes: 9,
                                ano: 2025,
                                dataCriacao: '01/09/2025',
                                dataPagamento: '08/09/2025'
                            },
                            {
                                id: 2,
                                alunoId: 2,
                                alunoNome: 'Ana Costa',
                                valor: 450.00,
                                vencimento: '15/09/2025',
                                status: 'pendente',
                                mes: 9,
                                ano: 2025,
                                dataCriacao: '01/09/2025'
                            }
                        ],
                        configuracoes: {
                            sheetId: '',
                            apiKey: '',
                            sheetName: 'Dados',
                            conectado: false
                        }
                    };
                }
            } catch (error) {
                console.error('Erro ao carregar dados:', error);
                dadosEscola = { 
                    alunos: [], 
                    funcionarios: [], 
                    movimentosCaixa: [], 
                    contratos: [],
                    boletos: [],
                    configuracoes: { sheetId: '', apiKey: '', sheetName: 'Dados', conectado: false } 
                };
            }
        }

        // Fun√ß√£o para mostrar alertas
        function mostrarAlerta(mensagem, tipo) {
            const alerta = document.createElement('div');
            alerta.className = `alert alert-${tipo}`;
            alerta.textContent = mensagem;
            alerta.style.position = 'fixed';
            alerta.style.top = '20px';
            alerta.style.right = '20px';
            alerta.style.zIndex = '9999';
            alerta.style.minWidth = '300px';
            
            document.body.appendChild(alerta);
            
            setTimeout(() => {
                if (document.body.contains(alerta)) {
                    document.body.removeChild(alerta);
                }
            }, 3000);
        }

        // Inicializa√ß√£o do sistema quando a p√°gina carrega
        document.addEventListener('DOMContentLoaded', function() {
            // Sistema j√° est√° inicializado no login
            console.log('Sistema de Gest√£o Escolar carregado com sucesso!');
        });
    </script>
</body>
</html> 
